## cookie session token 的区别？ 如何进行身份认证，保持用户登录态？

总所周知，HTTP是无状态的，也就是，当我们关闭网页（服务器），再次访问，服务器是没有意识到又是你来访问的，那服务器怎么保持我们的登录态呢？
这里有几种方法，不过核心的概念就是存储。
最简单的就是游览器记录你的账号密码。但是，这不是很安全的，但是呢，http是无状态的，即使我们不自己输入账号密码，游览器也得需要再我们每一次请求服务器的时候，加入账号和密码，这样才能做到保持登录
可以实现每次HTTP请求都自动带数据给服务器的技术，就是**cookie** ,它的流程如下：
1. 游览器发送HTTP请求。服务器会进行Cookie设置，也就是Set-Cookie，cookie中有名（name）和值（value）
2. 服务器会把名和值属性中的内容填充完整。Cookie发给游览器，游览器会保存起来，这样游览器以后发送的每一个请求都会带着Cookie，我们可以看到cookie就是存储在游览器的数据
3. 但是我们在游览器开发者工具中是可以看见cookie的，这样也就不安全了
#### 注意
- 每次发送请求，游览器都会自动发送cookie到对应的服务器中的

于是为了安全，也就产生了Session(会话)
1. 我们完全可以把游览器与服务器的通信看成一次会话，我们知道一次通信是有开始时间和结束时间的，Session的开始时间也就是，游览器访问服务器，结束时间是不好确定的，我们不能说关闭服务器就算是会话结束了，就像你打电话一样，你放下手机，不挂断，也是可以的
2. 因此不同网站对每个用户的会话都设定了时间及唯一的ID,这里的ID也就是常说的SessionID,时间也就是结束时间，因为是数据，应该保存在服务器数据库中
3. 客户端向服务端登录，服务端返回根据用户名和密码生成的SessionID和结束时间，客户端存储SessionID并把结束时间设置为cookie的有效期；
4. 服务器在发送cookie之前，是会对含有SessionID的Cookie进行签名，
5. 之后游览器每次访问服务器，都会发送保存在Cookie中的SessionID到服务器，知道Cookie的有效期失效，游览器会自动删除这个Cookie

#### Token

随着互联网发展，网民越来越多，如果同时有太多游览器访问你的服务器，那么服务器可能需要存储大量的SessionID在服务器中，这对服务器是有很大压力的
但是如果你的服务是多台服务器进行运行，于是又存在了需要同步SessionID到每个服务器，因为可能出现当前服务器超载，需要分担压力，把用户请求发送到其他服务器
那么我们会想把数据存入数据库，但是如果数据库崩溃了，那所有服务器都完了
于是就出现了一种技术JWT,即Json Web Token，

1. 用户输入账号密码登录网页，服务器就会生成一个JWT,服务器不需要存这个JWT,只需要保存JWT签名的密文，然后把JWT发给游览器，让游览器来存储JWT,
2. 游览器可以以Cookie 或者 Storage 的形式存储；和Session类型，但是数据存储地址改为了游览器，也就是客户端
**JWT由三部分组成**
header . payload . signature
1. header:声明用什么算法来生成签名
2. payload: 一些特定的数据 ，例如有效期等等
3. signature: 最终算法得到的签名信息
header 和 payload 两部分数据会经由 base64 编码， 注意是编码，不是加密，也就是说很好解码
虽然JWT不保存在服务器，但是服务器会保存一段密码，这段密码要结合两端编码进行算法运算，最终得到签名信息

如果我们修改JWT任何一个字符 都可能 整个JWT失效，所有JWT有一定安全性，但是也不是那么的安全


#### 总结
Session是诞生在服务器那边，并保存在服务器，由服务器主导一切
而Cookie则是一种数据的载体，把Session放在Cookie中送到客户端，Cookie跟随每个请求发送出去，
Token是诞生在服务器 存储在客户端（游览器）这边，由客户端主导一切，可以放在Cookie或者Storage中，持有Token就像持有令牌一样可以允许访问服务器